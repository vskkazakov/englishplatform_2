<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Entertaining English - –ú–æ–∏ —Å–ª–æ–≤–∞</title>
    <link rel="stylesheet" href="{% load static %}{% static 'dictionary/styles.css' %}?v=2.3">
    <script src="{% static 'dictionary/mobile-nav.js' %}?v=1.0" defer></script>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <span class="logo-text">Entertaining</span><span class="logo-accent">English</span>
            </div>
            <div class="nav">
                <a href="{% url 'index' %}" class="nav-link">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                <a href="{% url 'dictionary:index' %}" class="nav-link">–°–ª–æ–≤–∞—Ä—å</a>
                <a href="{% url 'tests:index' %}" class="nav-link">–¢–µ—Å—Ç—ã</a>
                <a href="{% url 'act_static:index' %}" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                <a href="{% url 'games:index' %}" class="nav-link">–ò–≥—Ä—ã</a>
                {% if user.is_authenticated %}
                    <span class="user-greeting">–ü—Ä–∏–≤–µ—Ç, {{ user.first_name|default:user.username }}!</span>
                    <a href="{% url 'authen:logout' %}" class="btn-login">–í—ã–π—Ç–∏</a>
                {% endif %}
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <section class="hero">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="title-accent">–ú–æ–∏ —Å–ª–æ–≤–∞</span>
                    </h1>
                    <p class="hero-description">
                        –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º —Å–ª–æ–≤–∞—Ä–Ω—ã–º –∑–∞–ø–∞—Å–æ–º –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å
                    </p>
                </div>
            </section>

            <!-- –î–µ–π—Å—Ç–≤–∏—è -->
            <section class="actions-section">
                <div class="actions-menu">
                    <a href="{% url 'dictionary:add_word' %}" class="action-link">
                        <span class="action-icon">‚ûï</span>
                        –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ
                    </a>
                    <a href="{% url 'dictionary:select_category' %}" class="action-link">
                        <span class="action-icon">üìÅ</span>
                        –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                    </a>
                </div>
            </section>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <section class="stats-overview">
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">üìö</div>
                        <div class="stat-number">{{ total_words }}</div>
                        <div class="stat-label">–í—Å–µ–≥–æ —Å–ª–æ–≤</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number">{{ total_filtered }}</div>
                        <div class="stat-label">–ù–∞–π–¥–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-number">{{ learned_filtered }}</div>
                        <div class="stat-label">–ò–∑—É—á–µ–Ω–æ</div>
                    </div>
                </div>
            </section>

            <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ -->
            <section class="search-filters">
                <div class="filters-container">
                    <form method="get" class="filters-form">
                        <div class="filters-row">
                            <div class="filter-group">
                                {{ search_form.search_query }}
                            </div>
                            <div class="filter-group">
                                {{ search_form.category }}
                            </div>
                            <div class="filter-group">
                                {{ search_form.difficulty_level }}
                            </div>
                            <div class="filter-group">
                                {{ search_form.status }}
                            </div>
                            <div class="filter-group">
                                {{ search_form.sort_by }}
                            </div>
                            <div class="filter-group">
                                <button type="submit" class="btn-primary">
                                    <span class="btn-icon">üîç</span>
                                    –ü–æ–∏—Å–∫
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </section>

            <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–ª–æ–≤ -->
            {% if words %}
            <section class="words-section">
                <div class="words-grid">
                    {% for word in words %}
                    <div class="word-card {% if word.is_learned %}learned{% elif word.needs_practice %}needs-practice{% endif %}">
                        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
                        <div class="word-header">
                            <span class="word-category">{{ word.category|title }}</span>
                            <div class="word-progress">
                                <div class="progress-circle" style="--progress: {{ word.get_progress_percentage }}%">
                                    <span class="progress-text">{{ word.times_practiced }}</span>
                                </div>
                                {% if word.is_learned %}
                                    <span class="word-status learned">‚úì</span>
                                {% elif word.needs_practice %}
                                    <span class="word-status needs-practice">!</span>
                                {% endif %}
                            </div>
                        </div>

                        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
                        <h3 class="word-english">{{ word.english_word|title }}</h3>
                        
                        {% if word.transcription %}
                            <p class="word-transcription">{{ word.transcription }}</p>
                        {% endif %}
                        
                        <p class="word-translation">{{ word.russian_translation }}</p>
                        
                        {% if word.definition %}
                            <p class="word-definition">{{ word.definition }}</p>
                        {% endif %}
                        
                        {% if word.example_sentence %}
                            <p class="word-example">{{ word.example_sentence }}</p>
                        {% endif %}

                        <!-- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ -->
                        <div class="word-meta">
                            <span class="meta-item">
                                üìä {{ word.get_difficulty_level_display }}
                            </span>
                            <span class="meta-item">
                                üìÖ {{ word.created_at|date:"d.m.Y" }}
                            </span>
                        </div>
                        
                        {% if word.last_practiced %}
                            <div class="word-last-practiced">
                                ‚è∞ –ò–∑—É—á–∞–ª–æ—Å—å: {{ word.last_practiced|date:"d.m.Y" }}
                            </div>
                        {% endif %}

                        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
                        <div class="word-actions">
                            <a href="{% url 'dictionary:edit_word' word.id %}" class="btn-secondary">
                                <span class="btn-icon">‚úèÔ∏è</span>
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </a>
                            
                            <form method="post" action="{% url 'dictionary:toggle_learned' word.id %}" class="action-form">
                                {% csrf_token %}
                                <button type="submit" class="btn {% if word.is_learned %}btn-success{% else %}btn-outline-success{% endif %}">
                                    <span class="btn-icon">‚úì</span>
                                    {% if word.is_learned %}–ò–∑—É—á–µ–Ω–æ{% else %}–ò–∑—É—á–∏—Ç—å{% endif %}
                                </button>
                            </form>
                            
                            <form method="post" action="{% url 'dictionary:delete_word' word.id %}" 
                                  class="action-form" 
                                  onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ {{ word.english_word }}?')">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-outline-danger">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                    –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </form>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                {% if words.has_other_pages %}
                <section class="pagination-section">
                    <div class="pagination">
                        {% if words.has_previous %}
                            <a href="?page={{ words.previous_page_number }}" class="page-link">
                                <span class="btn-icon">‚¨ÖÔ∏è</span>
                                –ù–∞–∑–∞–¥
                            </a>
                        {% endif %}
                        
                        {% for num in words.paginator.page_range %}
                            {% if words.number == num %}
                                <span class="page-link active">{{ num }}</span>
                            {% else %}
                                <a href="?page={{ num }}" class="page-link">{{ num }}</a>
                            {% endif %}
                        {% endfor %}
                        
                        {% if words.has_next %}
                            <a href="?page={{ words.next_page_number }}" class="page-link">
                                –î–∞–ª–µ–µ
                                <span class="btn-icon">‚û°Ô∏è</span>
                            </a>
                        {% endif %}
                    </div>
                </section>
                {% endif %}
            </section>
            {% else %}
            <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <section class="empty-state">
                <div class="empty-content">
                    <div class="empty-icon">üîç</div>
                    <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                    {% if request.GET.search_query or request.GET.category or request.GET.status %}
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</p>
                        <a href="{% url 'dictionary:view_words' %}" class="btn-secondary">
                            <span class="btn-icon">üîÑ</span>
                            –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                        </a>
                    {% else %}
                        <p>–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç —Å–ª–æ–≤ –≤ —Å–ª–æ–≤–∞—Ä–µ</p>
                        <a href="{% url 'dictionary:add_word' %}" class="btn-primary">
                            <span class="btn-icon">‚ú®</span>
                            –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ
                        </a>
                    {% endif %}
                </div>
            </section>
            {% endif %}
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Entertaining English</h4>
                    <p>–ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Å—Ç–∞–ª–æ –ø—Ä–æ—â–µ</p>
                </div>
                <div class="footer-section">
                    <h4>–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ª–æ–≤</h4>
                    <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º —Å–ª–æ–≤–∞—Ä–Ω—ã–º –∑–∞–ø–∞—Å–æ–º</p>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>
