<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Entertaining English - {{ title }}</title>
    <link rel="stylesheet" href="{% load static %}{% static 'dictionary/styles.css' %}?v=2.2">
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <span class="logo-text">Entertaining</span><span class="logo-accent">English</span>
            </div>
            <div class="nav">
                <a href="{% url 'index' %}" class="nav-link">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                <a href="{% url 'dictionary:index' %}" class="nav-link">–°–ª–æ–≤–∞—Ä—å</a>
                <a href="{% url 'tests:index' %}" class="nav-link">–¢–µ—Å—Ç—ã</a>
                <a href="{% url 'act_static:index' %}" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                <a href="{% url 'games:index' %}" class="nav-link">–ò–≥—Ä—ã</a>
                {% if user.is_authenticated %}
                    <span class="user-greeting">–ü—Ä–∏–≤–µ—Ç, {{ user.first_name|default:user.username }}!</span>
                    <a href="{% url 'authen:logout' %}" class="btn-login">–í—ã–π—Ç–∏</a>
                {% endif %}
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <section class="hero">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="title-accent">{{ title }}</span>
                    </h1>
                    <p class="hero-description">
                        –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "<strong>{{ category_name|title }}</strong>": 
                        <span class="category-counter">{{ words_in_category }}</span> —Å–ª–æ–≤
                    </p>
                </div>
            </section>

            <!-- –î–µ–π—Å—Ç–≤–∏—è -->
            <section class="actions-section">
                <div class="actions-menu">
                    <a href="{% url 'dictionary:select_category' %}" class="action-link">
                        <span class="action-icon">üîÑ</span>
                        –°–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                    </a>
                    <a href="{% url 'dictionary:create_category' %}" class="action-link">
                        <span class="action-icon">‚ûï</span>
                        –ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
                    </a>
                    <a href="{% url 'dictionary:view_words' %}" class="action-link">
                        <span class="action-icon">üìã</span>
                        –í—Å–µ —Å–ª–æ–≤–∞
                    </a>
                    <a href="{% url 'dictionary:index' %}" class="action-link">
                        <span class="action-icon">üè†</span>
                        –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </a>
                </div>
            </section>

            <div class="add-to-category-content">
                <!-- –§–æ—Ä–º–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
                <section class="quick-add-form">
                    <div class="form-container">
                        <h3 class="section-title-small">üöÄ –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤</h3>
                        
                        <form method="post" id="quickAddForm">
                            {% csrf_token %}
                            
                            <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è -->
                            <div class="form-section">
                                <h4 class="section-title-small">‚ú® –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="{{ form.english_word.id_for_label }}" class="form-label">
                                            üá¨üáß {{ form.english_word.label }} *
                                        </label>
                                        {{ form.english_word }}
                                        {% if form.english_word.errors %}
                                            <div class="error-message">
                                                {{ form.english_word.errors.0 }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.russian_translation.id_for_label }}" class="form-label">
                                            üá∑üá∫ {{ form.russian_translation.label }} *
                                        </label>
                                        {{ form.russian_translation }}
                                        {% if form.russian_translation.errors %}
                                            <div class="error-message">
                                                {{ form.russian_translation.errors.0 }}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>

                            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">
                                    <span class="btn-icon">‚ûï</span>
                                    –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ
                                </button>
                                <button type="button" class="btn-secondary" onclick="toggleOptionalFields()">
                                    <span class="btn-icon">‚öôÔ∏è</span>
                                    <span id="toggleText">–î–æ–ø. –ø–æ–ª—è</span>
                                </button>
                                <button type="reset" class="btn-secondary">
                                    <span class="btn-icon">üîÑ</span>
                                    –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>

                            <!-- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è -->
                            <div class="form-section optional-section" id="optionalFields">
                                <h4 class="section-title-small">‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</h4>
                                
                                <div class="form-group">
                                    <label for="{{ form.transcription.id_for_label }}" class="form-label">
                                        üîä {{ form.transcription.label }}
                                    </label>
                                    {{ form.transcription }}
                                    {% if form.transcription.errors %}
                                        <div class="error-message">
                                            {{ form.transcription.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="form-group">
                                    <label for="{{ form.definition.id_for_label }}" class="form-label">
                                        üìö {{ form.definition.label }}
                                    </label>
                                    {{ form.definition }}
                                    {% if form.definition.errors %}
                                        <div class="error-message">
                                            {{ form.definition.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="form-group">
                                    <label for="{{ form.example_sentence.id_for_label }}" class="form-label">
                                        üí¨ {{ form.example_sentence.label }}
                                    </label>
                                    {{ form.example_sentence }}
                                    {% if form.example_sentence.errors %}
                                        <div class="error-message">
                                            {{ form.example_sentence.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- –ü–∞–Ω–µ–ª—å –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–ª–æ–≤ -->
                <section class="recent-words-panel">
                    <h3 class="section-title-small">üìö –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ª–æ–≤–∞ –≤ "{{ category_name|title }}"</h3>
                    
                    <div class="recent-words-list" id="recentWords">
                        {% if recent_words %}
                            {% for word in recent_words %}
                                <div class="recent-word-item">
                                    <div class="word-content">
                                        <div class="word-english">{{ word.english_word }}</div>
                                        <div class="word-translation">{{ word.russian_translation }}</div>
                                    </div>
                                    <div class="word-status">‚úÖ</div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-words">
                                <div class="empty-icon">üìù</div>
                                <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ –≤ —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é!</p>
                            </div>
                        {% endif %}
                    </div>

                    <!-- –ë—ã—Å—Ç—Ä—ã–µ —Å–æ–≤–µ—Ç—ã -->
                    <div class="tips-card">
                        <h4 class="tips-title">üí° –ë—ã—Å—Ç—Ä—ã–µ —Å–æ–≤–µ—Ç—ã</h4>
                        <div class="tips-list">
                            <div class="tip-item">
                                <span class="tip-icon">‚ö°</span>
                                <span class="tip-text"><strong>Ctrl + Enter</strong> - –±—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–∏—Ç—å</span>
                            </div>
                            <div class="tip-item">
                                <span class="tip-icon">üìù</span>
                                <span class="tip-text">–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –º–Ω–æ–≥–æ —Å–ª–æ–≤ –±—ã—Å—Ç—Ä–æ</span>
                            </div>
                            <div class="tip-item">
                                <span class="tip-icon">üéØ</span>
                                <span class="tip-text">–ü–æ—Ç–æ–º –∑–∞–ø–æ–ª–Ω—è–π—Ç–µ –¥–æ–ø. –ø–æ–ª—è –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏</span>
                            </div>
                            <div class="tip-item">
                                <span class="tip-icon">üèÉ‚Äç‚ôÇÔ∏è</span>
                                <span class="tip-text">–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞ –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            {% if messages %}
            <section class="messages-section">
                <div class="messages-container">
                    {% for message in messages %}
                        <div class="message {{ message.tags }} word-success">
                            <div class="message-icon">‚úÖ</div>
                            <div class="message-content">
                                <div class="message-title">–£—Å–ø–µ—Ö!</div>
                                <div class="message-text">{{ message }}</div>
                            </div>
                            <button class="message-close" onclick="this.parentElement.remove()">√ó</button>
                        </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Entertaining English</h4>
                    <p>–ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Å—Ç–∞–ª–æ –ø—Ä–æ—â–µ</p>
                </div>
                <div class="footer-section">
                    <h4>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h4>
                    <p>–†–∞—Å—à–∏—Ä—è–π—Ç–µ —Å–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å –ø–æ —Ç–µ–º–∞–º</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
        function toggleOptionalFields() {
            const fields = document.getElementById('optionalFields');
            const toggleText = document.getElementById('toggleText');
            
            if (fields.style.display === 'none' || fields.style.display === '') {
                fields.style.display = 'block';
                toggleText.textContent = '–°–∫—Ä—ã—Ç—å';
            } else {
                fields.style.display = 'none';
                toggleText.textContent = '–î–æ–ø. –ø–æ–ª—è';
            }
        }

        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('quickAddForm').submit();
            }
        });

        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            const englishInput = document.getElementById('id_english_word');
            if (englishInput) {
                englishInput.focus();
                
                // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—á–∏—â–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
                const form = document.getElementById('quickAddForm');
                form.addEventListener('submit', function() {
                    setTimeout(() => {
                        if (!form.querySelector('.error-message')) {
                            englishInput.value = '';
                            document.getElementById('id_russian_translation').value = '';
                            englishInput.focus();
                        }
                    }, 100);
                });
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        setTimeout(function() {
            const messages = document.querySelectorAll('.message');
            messages.forEach(function(message) {
                message.style.opacity = '0';
                setTimeout(() => message.remove(), 300);
            });
        }, 3000);
    </script>
</body>
</html>
