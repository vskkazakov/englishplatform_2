<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Entertaining English - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</title>
    <link rel="stylesheet" href="{% load static %}{% static 'act_static/styles.css' %}?v=2.1">
    <script src="{% static 'mysite/mobile-nav.js' %}?v=1.0" defer></script>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <span class="logo-text">Entertaining</span><span class="logo-accent">English</span>
            </div>
            <div class="nav">
                <a href="{% url 'index' %}" class="nav-link">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                <a href="{% url 'dictionary:index' %}" class="nav-link">–°–ª–æ–≤–∞—Ä—å</a>
                <a href="{% url 'tests:index' %}" class="nav-link">–¢–µ—Å—Ç—ã</a>
                <a href="{% url 'act_static:index' %}" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                <a href="{% url 'games:index' %}" class="nav-link">–ò–≥—Ä—ã</a>
                {% if user.is_authenticated %}
                    <span class="user-greeting">–ü—Ä–∏–≤–µ—Ç, {{ user.first_name|default:user.username }}!</span>
                    <a href="{% url 'authen:logout' %}" class="btn-login">–í—ã–π—Ç–∏</a>
                {% endif %}
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <section class="hero">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="title-accent">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑—É—á–µ–Ω–∏—è</span>
                    </h1>
                    <p class="hero-description">
                        –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –∏–∑—É—á–µ–Ω–∏–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
                    </p>
                </div>
            </section>

            <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <section class="stats-overview">
                <h2 class="section-title">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">üìö</div>
                        <div class="stat-number">{{ total_words }}</div>
                        <div class="stat-label">–í—Å–µ–≥–æ —Å–ª–æ–≤</div>
                    </div>
                    
                    <div class="stat-card success">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number">{{ learned_words }}</div>
                        <div class="stat-label">–í—ã—É—á–µ–Ω–æ</div>
                    </div>
                    
                    <div class="stat-card warning">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-number">{{ words_need_practice }}</div>
                        <div class="stat-label">–¢—Ä–µ–±—É—é—Ç –ø—Ä–∞–∫—Ç–∏–∫–∏</div>
                    </div>
                    
                    <div class="stat-card info">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-number">{{ achievements.current_streak }}</div>
                        <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
            </section>

            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            <section class="progress-achievements">
                <div class="progress-achievements-grid">
                    <div class="progress-card">
                        <h3 class="card-title">–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                        <div class="progress-circle">
                            <div class="progress-circle-inner">
                                <span class="progress-percentage">{{ progress_percentage }}%</span>
                            </div>
                        </div>
                        <p class="progress-text">
                            <strong>{{ learned_words }}</strong> –∏–∑ <strong>{{ total_words }}</strong> —Å–ª–æ–≤ –∏–∑—É—á–µ–Ω–æ
                        </p>
                        <div class="progress-motivation">
                            {% if progress_percentage >= 80 %}
                                üéØ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –í—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏!
                            {% elif progress_percentage >= 50 %}
                                üí™ –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!
                            {% elif progress_percentage >= 20 %}
                                üöÄ –•–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ! –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ—Å—å!
                            {% else %}
                                üìö –ù–∞—á–∏–Ω–∞–π—Ç–µ –∏–∑—É—á–µ–Ω–∏–µ! –£–¥–∞—á–∏!
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="achievements-card">
                        <h3 class="card-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                        <div class="achievements-grid">
                            <div class="achievement-item">
                                <div class="achievement-icon">üìÖ</div>
                                <div class="achievement-content">
                                    <div class="achievement-number">{{ achievements.current_streak }}</div>
                                    <div class="achievement-label">–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è</div>
                                </div>
                            </div>
                            
                            <div class="achievement-item">
                                <div class="achievement-icon">‚≠ê</div>
                                <div class="achievement-content">
                                    <div class="achievement-number">{{ achievements.best_streak }}</div>
                                    <div class="achievement-label">–õ—É—á—à–∞—è —Å–µ—Ä–∏—è</div>
                                </div>
                            </div>
                            
                            <div class="achievement-item">
                                <div class="achievement-icon">üìÅ</div>
                                <div class="achievement-content">
                                    <div class="achievement-number">{{ achievements.categories_count }}</div>
                                    <div class="achievement-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                                </div>
                            </div>
                            
                            <div class="achievement-item">
                                <div class="achievement-icon">‚è±Ô∏è</div>
                                <div class="achievement-content">
                                    <div class="achievement-number">{{ achievements.practice_time }}–º</div>
                                    <div class="achievement-label">–í—Ä–µ–º–µ–Ω–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º -->
            {% if daily_learned_words %}
            <section class="daily-activity">
                <h2 class="section-title">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–Ω–∏</h2>
                <div class="activity-timeline">
                    {% for day in daily_learned_words %}
                        <div class="activity-item">
                            <div class="activity-header">
                                <div class="activity-date">
                                    <div class="date-main">{{ day.date_formatted }}</div>
                                    <div class="date-day">{{ day.day_name }}</div>
                                </div>
                                <div class="activity-stats">
                                    <span class="stat-badge">
                                        üìö {{ day.words_practiced }}
                                    </span>
                                    <span class="stat-badge">
                                        ‚úÖ {{ day.words_learned }}
                                    </span>
                                </div>
                            </div>
                            
                            {% if day.words_list %}
                                <div class="activity-words">
                                    <div class="words-label">–ò–∑—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞:</div>
                                    <div class="words-grid">
                                        {% for word in day.words_list %}
                                            <span class="word-tag">
                                                <strong>{{ word.english_word }}</strong> ‚Üí {{ word.russian_translation }}
                                                <small>({{ word.category }})</small>
                                            </span>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endif %}
                            
                            <div class="activity-achievement">
                                {% if day.words_learned >= 10 %}
                                    üèÜ
                                {% elif day.words_learned >= 5 %}
                                    ü•á
                                {% elif day.words_learned > 0 %}
                                    ‚≠ê
                                {% else %}
                                    üìñ
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
            {% if category_stats %}
            <section class="category-progress">
                <h2 class="section-title">–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h2>
                <div class="categories-grid">
                    {% for category in category_stats %}
                        <div class="category-card">
                            <div class="category-header">
                                <h4 class="category-name">{{ category.category|title }}</h4>
                                <span class="category-percentage {% if category.progress >= 80 %}high{% elif category.progress >= 50 %}medium{% else %}low{% endif %}">
                                    {{ category.progress }}%
                                </span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill {% if category.progress >= 80 %}high{% elif category.progress >= 50 %}medium{% else %}low{% endif %}" 
                                     style="width: {{ category.progress }}%"></div>
                            </div>
                            <div class="category-stats">
                                {{ category.learned }}/{{ category.total }} —Å–ª–æ–≤ –∏–∑—É—á–µ–Ω–æ
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤ -->
            <section class="test-stats">
                <h2 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤</h2>
                <div class="test-stats-grid">
                    <div class="test-stat-card">
                        <div class="test-stat-icon">üìù</div>
                        <div class="test-stat-number">{{ test_stats.total_tests }}</div>
                        <div class="test-stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                    
                    <div class="test-stat-card">
                        <div class="test-stat-icon">üìä</div>
                        <div class="test-stat-number">{{ test_stats.avg_success }}%</div>
                        <div class="test-stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                    </div>
                    
                    <div class="test-stat-card">
                        <div class="test-stat-icon">‚è±Ô∏è</div>
                        <div class="test-stat-number">{{ test_stats.avg_time }}</div>
                        <div class="test-stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (–º–∏–Ω)</div>
                    </div>
                    
                    <div class="test-stat-card">
                        <div class="test-stat-icon">‚úÖ</div>
                        <div class="test-stat-number">{{ test_stats.total_correct }}/{{ test_stats.total_questions }}</div>
                        <div class="test-stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                    </div>
                </div>
            </section>

            <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–µ—Å—Ç—ã -->
            {% if recent_tests %}
            <section class="recent-tests">
                <h2 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–µ—Å—Ç—ã</h2>
                <div class="tests-table">
                    <div class="table-header">
                        <div class="table-cell">–î–∞—Ç–∞</div>
                        <div class="table-cell">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
                        <div class="table-cell">–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
                        <div class="table-cell">–í—Ä–µ–º—è</div>
                    </div>
                    
                    {% for test in recent_tests %}
                        <div class="table-row">
                            <div class="table-cell">{{ test.start_time|date:"d.m.Y H:i" }}</div>
                            <div class="table-cell">{{ test.get_categories_display|truncatechars:30 }}</div>
                            <div class="table-cell">
                                <div class="result-bar {% if test.get_success_rate >= 80 %}high{% elif test.get_success_rate >= 60 %}medium{% else %}low{% endif %}">
                                    {{ test.get_success_rate }}%
                                </div>
                            </div>
                            <div class="table-cell">{{ test.get_duration_minutes }} –º–∏–Ω</div>
                        </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ -->
            {% if recent_learned_words %}
            <section class="recent-words">
                <h2 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</h2>
                <div class="words-grid">
                    {% for word in recent_learned_words %}
                        <div class="word-card">
                            <h4 class="word-english">{{ word.english_word }}</h4>
                            <p class="word-translation">{{ word.russian_translation }}</p>
                            <div class="word-meta">
                                <span class="word-category">{{ word.category }}</span>
                                {% if word.last_practiced %}
                                    <span class="word-time">{{ word.last_practiced|date:"d.m H:i" }}</span>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            {% if not total_words %}
            <section class="empty-state">
                <div class="empty-content">
                    <div class="empty-icon">üìä</div>
                    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤</h3>
                    <p>–ù–∞—á–Ω–∏—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–ª–æ–≤–∞ –≤ —Å–≤–æ–π —Å–ª–æ–≤–∞—Ä—å, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–∑—É—á–µ–Ω–∏—è</p>
                    <a href="{% url 'dictionary:add_word' %}" class="btn-primary">
                        <span class="btn-icon">‚ú®</span>
                        –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ
                    </a>
                </div>
            </section>
            {% endif %}

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <section class="navigation">
                <div class="nav-buttons">
                    <a href="{% url 'index' %}" class="btn-secondary">
                        <span class="btn-icon">üè†</span>
                        –ì–ª–∞–≤–Ω–∞—è
                    </a>
                    <a href="{% url 'dictionary:index' %}" class="btn-secondary">
                        <span class="btn-icon">üìö</span>
                        –°–ª–æ–≤–∞—Ä—å
                    </a>
                    <a href="{% url 'dictionary:view_words' %}" class="btn-secondary">
                        <span class="btn-icon">üìñ</span>
                        –ú–æ–∏ —Å–ª–æ–≤–∞
                    </a>
                    <a href="{% url 'dictionary:study_setup' %}" class="btn-primary">
                        <span class="btn-icon">üéì</span>
                        –ò–∑—É—á–∞—Ç—å
                    </a>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Entertaining English</h4>
                    <p>–ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Å—Ç–∞–ª–æ –ø—Ä–æ—â–µ</p>
                </div>
                <div class="footer-section">
                    <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                    <p>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</p>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>