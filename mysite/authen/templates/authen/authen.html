<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Английский Онлайн</title>
    <link rel="stylesheet" href="{% load static %}{% static 'authen/styles.css' %}">
</head>
<body>
    <div class="container">
        {% if user.is_authenticated %}
            <div class="user-info">
                <span>Привет, {{ user.first_name }}!</span>
                <a href="{% url 'authen:logout' %}" class="logout-btn">Выйти</a>
            </div>
        {% endif %}

        {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <div class="message {{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <div class="auth-container">
            <div class="tab-buttons">
                <button class="tab-btn {% if show_registration %}active{% endif %}" onclick="showRegistration()">Регистрация</button>
                <button class="tab-btn {% if not show_registration %}active{% endif %}" onclick="showLogin()">Вход</button>
            </div>

            <div class="registration-form {% if show_registration %}active{% endif %}">
                <h2>Создать аккаунт</h2>
                <form method="POST" novalidate>
                    {% csrf_token %}
                    
                    {% if registration_form.non_field_errors %}
                        <div class="error">
                            {{ registration_form.non_field_errors }}
                        </div>
                    {% endif %}
                    
                    <div class="form-group">
                        {{ registration_form.first_name.label_tag }}
                        {{ registration_form.first_name }}
                        {% for error in registration_form.first_name.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="form-group">
                        {{ registration_form.email.label_tag }}
                        {{ registration_form.email }}
                        {% for error in registration_form.email.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="form-group">
                        {{ registration_form.password1.label_tag }}
                        {{ registration_form.password1 }}
                        {% for error in registration_form.password1.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="form-group">
                        {{ registration_form.password2.label_tag }}
                        {{ registration_form.password2 }}
                        {% for error in registration_form.password2.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="form-group role-selection">
                        {{ registration_form.role.label_tag }}
                        {{ registration_form.role }}
                        {% for error in registration_form.role.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <button type="submit" name="register">Зарегистрироваться</button>
                </form>
            </div>

            <div class="login-form {% if not show_registration %}active{% endif %}">
                <h2>Войти в систему</h2>
                <form method="POST" novalidate>
                    {% csrf_token %}
                    
                    <div class="form-group">
                        {{ login_form.email.label_tag }}
                        {{ login_form.email }}
                        {% for error in login_form.email.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="form-group">
                        {{ login_form.password.label_tag }}
                        {{ login_form.password }}
                        {% for error in login_form.password.errors %}
                            <div class="error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <button type="submit" name="login">Войти</button>
                </form>
            </div>
        </div>

        <footer>
            <p>Ваши данные защищены и сохраняются в PostgreSQL</p>
        </footer>
    </div>

    <script>
        function showRegistration() {
            document.querySelector('.registration-form').classList.add('active');
            document.querySelector('.login-form').classList.remove('active');
            document.querySelectorAll('.tab-btn')[0].classList.add('active');
            document.querySelectorAll('.tab-btn')[1].classList.remove('active');
        }

        function showLogin() {
            document.querySelector('.login-form').classList.add('active');
            document.querySelector('.registration-form').classList.remove('active');
            document.querySelectorAll('.tab-btn')[1].classList.add('active');
            document.querySelectorAll('.tab-btn')[0].classList.remove('active');
        }
    </script>
</body>
</html>
